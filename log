Starting process...
Using CUDA device 0
Reading COLMAP point cloud...
Loaded 52818 3D points
Reading COLMAP camera and image data...
Number of cameras: 1
Camera 1: SIMPLE_PINHOLE, 1237x822, 3 params
Number of images: 194
Reading images:   0%|                                   | 0/194 [00:00<?, ?it/s]Reading images: 100%|██████████████████████| 194/194 [00:00<00:00, 99122.30it/s]
Successfully read 194 images
Found 1 cameras and 194 images
Reading depth map...
Depth map shape: (822, 1237)

Validating camera parameters...
Camera validation results: {
  "focal_length": {
    "fx": 1162.015142304824,
    "fy": 1162.015142304824
  },
  "principal_point": {
    "cx": 618.5,
    "cy": 411.0
  },
  "quaternion_norm": 1.0
}

Checking mask and depth map...

Depth statistics in mask region:
Min depth: 0.2283
Max depth: 0.5677
Mean depth: 0.5218
Median depth: 0.5227
Starting memory-efficient alignment process...
Ground normal: [-0.02782256  0.98534019  0.16831703]
Initial scale estimate: 4.116871954402257
Target position estimate: [-3.2383647   0.80327875 -1.21159135]

Starting optimization...

Optimization stage 1/3...
Iter 20: Error = 2.209002 (Point: 0.1000, Pos: 6.3238, Height: 0.4237)Iter 40: Error = 2.156244 (Point: 0.1000, Pos: 6.2625, Height: 0.3550)Iter 160: Error = 1.913745 (Point: 0.1000, Pos: 5.9856, Height: 0.0361)Iter 180: Error = 1.899008 (Point: 0.1000, Pos: 5.9685, Height: 0.0169)
Optimization stage 2/3...
Iter 200: Error = 1.877249 (Point: 0.1000, Pos: 5.6143, Height: 0.1859)Iter 240: Error = 1.242064 (Point: 0.1000, Pos: 3.8064, Height: 0.0003)Iter 300: Error = 0.151251 (Point: 0.1000, Pos: 0.1708, Height: 0.0000)
Optimization stage 3/3...

Optimization completed in 83.8s
Alignment parameters: [4.703263119159416, -0.9864331487593359, 1.6731397074476533, -6.078713140663689]

Analyzing transform parameters...
Transform analysis: {
  "scale": 4.703263119159416,
  "translation": {
    "x": -0.9864331487593359,
    "y": 1.6731397074476533,
    "z": -6.078713140663689
  },
  "translation_magnitude": 6.381473206406707
}
Saving transform parameters...
Unprojecting object points...
Generated 27683 object points

Checking point cloud alignment...
Alignment metrics: {
  "relative_scale": 0.008569454031545595,
  "center_distance": 3.9392535044543044
}
Combining point clouds...
Estimating normals...
Successfully saved combined point cloud to /eva_data/hentci/mip-nerf-360/trigger_bicycle_1pose_DPT/aligned_objects/combined_pointcloud.ply
Process completed!
